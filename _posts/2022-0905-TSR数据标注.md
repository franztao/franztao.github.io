---
layout:     post
title:      TSR数据标注
subtitle:   2022年8月
date:       2022-8-31
author:     franztao
header-img: post-bg-re-vs-ng2.jpg
catalog: true
tags:
    - Blog

---

一、整体要求

1、对表格图片进行类别标注，对图片上的表格画横和竖的物理实线，在完成横和竖的实线后表格形成m*n的长方形格子区域，对语义上是相关的物理格子进行合并。

2、最终交付的标注成果数据为 JSON 格式文件。

二、 标注对象

| 元素  | 定义          | 备注  |
| --- | ----------- | --- |
| 横线  |             |     |
| 竖线  |             |     |
| 黄线  | 语义上是相关的物理格子 |     |

标注样例：

| 样例名                                      | 图片                                                                                                       |
| ---------------------------------------- | -------------------------------------------------------------------------------------------------------- |
| jm200385u(OT_MT1,MT2_cl_vdss).pdf_6_9    | ![](https://raw.githubusercontent.com/franztao/blog_picture/main/marktext/2022-09-15-20-22-07-image.png) |
| jm200386s(OT_PI3K,mTOR_cl_vdss).pdf_10_5 | ![](https://raw.githubusercontent.com/franztao/blog_picture/main/marktext/2022-09-15-20-24-14-image.png) |
| jm200712h（pdb_FLT3_Cl）.pdf_6_16          | ![](https://raw.githubusercontent.com/franztao/blog_picture/main/marktext/2022-09-15-20-26-00-image.png) |
| jm200900q（pdb_OT_FMS_Cl）.pdf_12_13       | ![](https://raw.githubusercontent.com/franztao/blog_picture/main/marktext/2022-09-15-20-27-17-image.png) |

三、标注数据前统计（数据元信息）

| 字段       | 子字段     | 含义                                                                                                           |
| -------- | ------- | ------------------------------------------------------------------------------------------------------------ |
| 数据来源     |         | 公开数据集，数据采购&采集，数据回流，生成数据                                                                                      |
| 图片信息     | 存储格式    | pdf   图片                                                                                                     |
|          | 宽度      |                                                                                                              |
|          | 高度      |                                                                                                              |
|          | 分辨率/清晰度 |                                                                                                              |
| 标注管理信息   | 标注人员    |                                                                                                              |
|          | 标注时间    |                                                                                                              |
|          | 标注状态    |                                                                                                              |
| 文档类型     |         | 期刊       专利                                                                                                  |
| 文档来源     |         |                                                                                                              |
| 研究领域     |         |                                                                                                              |
| **表格分类** | 展现形式    | 垂直<br/> 水平<br/> 旋转X度                                                                                         |
|          | 记录方式    | 电子记录<br/> 手写<br/> 扫描                                                                                         |
|          | 语义表达形式  | 竖表<br/> 横表（行名为化合物名称，列名为各药化属性）<br/> 复合表（compound在表标题上）                                                        |
|          | 表格内容    | 单表<br/> 多表                                                                                                   |
|          | 格子线形式   | Lattice 有线表: For tables formed with lines.<br/> Stream 无线表: For tables formed with whitespaces.<br/>表头有线表体无线 |
|          | 格子逻辑结构  | 同一列里展示两列数据<br/> 两列上面有共同的主列                                                                                   |
| 标注存储格式   | 坐标类型    | xyx1y1  xywh                                                                                                 |

四、标注原则：

1）画线规则：

> 1.在预标注不满足的情况下，需要重新画横或者竖线的，第一依据是在需要画线的范围内，范围内本来有一条图片的实线存在，则沿着实线画横或者竖线。
> 
> 2.无实线的，则在空白中间上画，即绿色格子的相互中间区域

2）直线穿过原则：画线不能穿过分子式，完整字符之间等有颜色的像素字符

3）边界原则：边界线跟实际表格区域不多于5 pt(肉眼可见能分开线与表格内的字符元素)

4）标注顺序规则：

> 1.确定横线（红线）是否画好
> 2.确定竖线（蓝线）是否画好
> 3.确定合并区域（黄线,逻辑格子）是否画好
> 4.画缺失的横、竖线
> 5.删除冗余的横、竖线
> 6.成完整田字表格后，合并应该合并成一起的物理格子
> 7.删除冗余的合并区域（黄线）

三、常见标注错误（持续补充）：

| 错误类型 | 违反规则 | 错误分析                | 样例                                              |                                                                                                          |
| ---- | ---- | ------------------- | ----------------------------------------------- | -------------------------------------------------------------------------------------------------------- |
| 线段不对 |      | 第一行物理像素上分开，逻辑上不应该分开 | jm200712h（pdb_FLT3_Cl）.pdf_5_3                  | ![](https://raw.githubusercontent.com/franztao/blog_picture/main/marktext/2022-09-15-20-29-13-image.png) |
| 格子不对 |      | 少合并格子               |                                                 |                                                                                                          |
|      |      | 合并格子多合并冗余物理格子       | jm2014887(OT_Glucokinase_cl_papp_vdss).pdf_6_15 | ![](https://raw.githubusercontent.com/franztao/blog_picture/main/marktext/2022-09-15-20-10-46-image.png) |
|      |      | 合并格子多合并冗余物理格子       | jm2014887(OT_Glucokinase_cl_papp_vdss).pdf_6_10 | ![](https://raw.githubusercontent.com/franztao/blog_picture/main/marktext/2022-09-15-20-13-54-image.png) |
|      |      |                     | jm2012968(OT_GPR40,FFA1_cl).pdf_8_4             | ![](https://raw.githubusercontent.com/franztao/blog_picture/main/marktext/2022-09-15-20-17-21-image.png) |

五、标注检查规范：

线错的情况分类

线不准的情况分类

1. 缺线数量

2. 多线数量

格子不准的情况分类

   1. 多逻辑格子数量

    2. 少逻辑格子数量

六、标注质量指标（交付数据的质控标准）

1. 线缺数

2. 线多数

3. 格缺数

4. 格多数

5. 线错数

七、数据标注流程

1. 数据采集，算法提供预标注的表格图片，表格图片来自表格检测的标注数据

2. 数据预处理，表格图片会经过掩盖ocsr分子处理

3. 数据管理，元数据信息字段（同DOD数据标注任务）

   4.模型预标注，在通过模型预标注之后，需要检查预标注结果以此来挖掘试标注的不足之处，随后根据不足之处进行补充标注。

   5.交付标注数据，导入成COCO数据格式，统计标注质量，标注结果汇总统计

八、标注数据范围和计划

| 元素     | 是否算法预标注 | 是否需要标注和基于预标注修正 |
| ------ | ------- | -------------- |
| 横线     | 是       | 是              |
| 竖线     | 否       | 是              |
| 黄线     | 否       | 是              |
| 语义表达形式 |         | 是              |

| 事件    | 数据规模  | 工期  | 人员配比 | 交付要求    |
| ----- | ----- | --- | ---- | ------- |
| 预标注   | 100   |     |      | 准确率≥99% |
| 第一批标注 | 30W图片 |     |      | 准确率≥99% |
|       |       |     |      |         |
